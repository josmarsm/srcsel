(function(n){n.fn.maskMoney=function(e){return e=n.extend({symbol:"US$",decimal:".",precision:2,thousands:",",showSymbol:!0},e),e.symbol=e.symbol+" ",this.each(function(){function r(n){n=n||window.event;var e=n.charCode||n.keyCode||n.which;if(8==e){i(n);var r=u.val().substring(0,u.val().length-1);return u.val(t(r)),!1}if(9==e)return!0;if(48>e||e>57)return i(n),!0;var o=String.fromCharCode(e);i(n),u.val(t(u.val()+o))}function i(n){n.preventDefault?n.preventDefault():n.returnValue=!1}function t(n){n=n.replace(e.symbol,"");var r="",i="0123456789",t=n.length,o="";0==t&&(o="0.00");for(var a=0;t>a&&("0"==n.charAt(a)||n.charAt(a)==e.decimal);a++);for(;t>a;a++)-1!=i.indexOf(n.charAt(a))&&(r+=n.charAt(a));var s=parseFloat(r);s=isNaN(s)?0:s/Math.pow(10,e.precision),o=s.toFixed(e.precision);var u,c=(o=o.split("."))[1].substr(0,e.precision);for(u=(o=o[0]).length;(u-=3)>=1;)o=o.substr(0,u)+e.thousands+o.substr(u);return l(o+e.decimal+c+Array(e.precision+1-c.length).join(0))}function o(){""==u.val()?u.val(l(s())):u.val(l(u.val()))}function a(){u.val()==l(s())?u.val(""):u.val(u.val().replace(e.symbol,""))}function s(){var n=parseFloat("0")/Math.pow(10,e.precision);return n.toFixed(e.precision).replace(RegExp("\\.","g"),e.decimal)}function l(n){return e.showSymbol?e.symbol+n:n}var u=n(this);u.bind("keypress",r),u.bind("blur",a),u.bind("focus",o),u.one("unmaskMoney",function(){u.unbind("focus",o),u.unbind("blur",a),u.unbind("keypress",r),n.browser.msie?this.onpaste=null:n.browser.mozilla&&this.removeEventListener("input",a,!1)})})},n.fn.unmaskMoney=function(){return this.trigger("unmaskMoney")}})(jQuery);